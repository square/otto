<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Otto - An event bus by Square, Inc.</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="An enhanced Guava-based event bus with emphasis on Android support." />
    <link href="bootstrap.min.css" rel="stylesheet">
    <link href="bootstrap-responsive.min.css" rel="stylesheet">
    <link href="prettify.css" rel="stylesheet">
    <link href="app.css" rel="stylesheet">
</head>
<body>
<div class="container">
    <div class="row">
        <div class="span4 side">
            <h1>Otto</h1>
            <h3>An enhanced Guava-based event bus with emphasis on Android support.</h3>
            <ul class="unstyled">
                <li><a href="http://github.com/square/otto" class="btn btn-large btn-inverse" id="download">Download</a></li>
            </ul>
            <img src="square.png" alt="by Square, Inc.">
      </div>
        <div class="offset4 span8 main"><div class="main-inner">
            <h4>Introduction</h4>
            <p>Otto is an Android-optimized event bus forked from Guava that helps discrete parts of your
            application communicate efficiently.</p>
            
            <h4>Usage</h4>
            <p>Otto is intended for use as a singleton (although this is not required). These examples assume you have an
            instance of the <code>Bus</code> class in the variable <code>bus</code> obtained through injection or 
            another appropriate mechanism.</p>
            
            <h5>Publishing</h5>
            <p>To publish a new event, call the <code>post</code> method, providing an instance of any class:</p>
            <pre class="prettyprint">bus.post(new AnswerAvailableEvent(42));</pre>
            <p>The bus calls every method that subscribes to events of the argument's type, passing along the
            argument itself. In most cases, this is a synchronous actionâ€”when program execution continues, it's
            guaranteed that all subscribing methods have been called. This is <em>not</em> a synchronous
            action, however, if it's called during the execution of another bus method. In that case, the event
            is enqueued for publication after the current bus method returns.</p>

            <h5>Subscribing</h5>
            <p>To subscribe to events of a particular type, annotate a method with <code>@Subscribe</code>. 
            The method should take only a single parameter: the event type you want to subscribe to.</p>
            <p>To receive the event published in the previous example, you need the following:</p>
            <pre class="prettyprint">@Subscribe public void answerAvailable(AnswerAvailableEvent event) {
    // TODO: React to the event somehow!
}</pre>
            <p>The name of the method can be anything you like. The annotation, argument type, and <code>public</code>
            accessor are required.</p>
            <p>Additionally, a class instance needs to register with the bus before its methods (such as 
            <code>answerAvailable</code>) can receive events:</p>
            <pre class="prettyprint">bus.register(this);</pre>
            <p>A class instance can call the <code>unregister</code> method to stop receiving events. See the 
            sample application included in the download for a complete example.</p>
            <p><strong>Note: Registering only applies to methods of the immediate class type.</strong> Unlike the Guava event
            bus, Otto does not traverse the class hierarchy and add annotated methods from base classes or interfaces.
            This is an explicit design decision to improve performance of the library and keep your
            code simple and unambiguous.</p>

            <h5>Producing</h5>
            <p>When you first subscribe to an event type, you often want to know something about the current state of 
            the world (e.g., the most recently published event). To address this, Otto adds the concept of
            <strong>producers</strong>, methods that provide an immediate callback to subscribers as soon as they've
            registered with the bus.</p>
            <p>To create a producer, annotate a method with <code>@Produce</code>. The method should take no parameters,
            and its return type should be the event type it's associated with. If you're keeping track of the most recent
            <code>AnswerAvailableEvent</code>, you can register a producer to provide it to newly registered subscribers:</p>
            <pre class="prettyprint">@Produce public AnswerAvailableEvent produceAnswer() {
    // Assuming 'lastAnswer' exists.
    return new AnswerAvailableEvent(this.lastAnswer);
}</pre>
            <p>Producers, like subscribers, must be registered:</p>
            <pre class="prettyprint">bus.register(this);</pre>
            <p>When it's registered, the producer is called once for each <em>existing</em> subscriber of
            the same type. Thereafter, it's called once for each new subscriber of the same type.</p>
            <p><strong>Note: You can have only one producer per event type registered at a time on a bus.</strong></p>

            <h5>Thread Enforcement</h5>
            <p>Otto provides an enforcement mechanism to ensure you always receive callbacks on the thread you want.
            By default, all interaction with an instance is confined to the main thread.</p>
            <pre class="prettyprint">// These are functionally equivalent.
Bus bus1 = new Bus();
Bus bus2 = new Bus(ThreadEnforcer.MAIN);</pre>
            <p>If you don't care which thread interactions happen on, instantiate a bus instance with
            <code>ThreadEnforcer.ANY</code>. You can also provide your own implementation of the
            <code>ThreadEnforcer</code> interface if you need additional functionality or validation.</p>

            <h4>Including In Your Application</h4>
            <p>Otto is packaged as a standalone <code>.jar</code> file that you can place in the <code>libs/</code> folder
            of your application. It is compatible with all versions of Android and has no minimum SDK requirement. You
            can download the latest <code>.jar</code> on the GitHub project by clicking the <strong>Download</strong> button.</p>
            <p>If you're a Maven user, you can also fetch Otto from the central repositories by including the following
            dependnecy in your application's <code>pom.xml</code>:</p>
            <pre class="prettyprint">&lt;dependency>
    &lt;groupId>com.squareup&lt;/groupId>
    &lt;artifactId>otto&lt;/artifactId>
    &lt;version><em>(insert latest version)</em>&lt;/version>
&lt;/dependency></pre>
            <p>After you've installed Otto, add the following lines to your <code>proguard-project.txt</code> file:</p>
            <pre class="prettyprint">-keepclassmembers class ** {
    @com.squareup.otto.Subscribe public *;
    @com.squareup.otto.Produce public *;
}</pre>
            <p>This ensures your annotated methods aren't removed by ProGuard.</p>

            <h4>Contributing</h4>
            <p>If you'd like to contribute code to Otto, you can do so through GitHub by forking the repository and
            sending a pull request.</p>
            <p>When submitting code, please make every effort to follow existing conventions and style in order to keep
            the code as readable as possible. Please also make sure your code compiles by running <code>mvn clean
            verify</code>. Checkstyle failures during compilation indicate errors in your style and can be viewed in the
            <code>checkstyle-result.xml</code> file.</p>
            <p>Before your code can be accepted into the project you must also sign the
            <a href="https://spreadsheets.google.com/spreadsheet/viewform?formkey=dDViT2xzUHAwRkI3X3k5Z0lQM091OGc6MQ&ndplr=1">Individual
            Contributor License Agreement (CLA)</a>.</p>

            <h4>License</h4>
            <pre class="license">Copyright 2012 Square, Inc.
Copyright 2010 Google, Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</pre>

            <a id="ribbon" href="https://github.com/square/otto"><img src="ribbon.png" alt="Fork me on GitHub"></a>
        </div></div>
    </div>
</div>
<script src="prettify.js"></script>
<script> prettyPrint(); </script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="jquery-maven-artifact.min.js"></script>
<script>
    $.fn.artifactVersion('com.squareup', 'otto', function(version, url) {
        $('#download').attr('href', url).text('Download v' + version);
    });
</script>
</body>
</html>
